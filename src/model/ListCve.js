import mongoose from "mongoose";


const CveListSchema = new mongoose.Schema({
    cveId : {type : String , required : true} , 
    sourceIdentifier : {type : String , required : true} , 
    published : {type : String , required : true} ,
    lastModified : {type : String , required : true} , 
    vulnStatus : {type : String , required : true},
    descriptions: [{
        lang: { type: String, required: true },
        value: { type: String, required: true }
    }],

    // ===cvssMetricV2 ===
    baseSeverity : {type : String , required : true},
    baseScore : {type : String , required : true},
    vectorString : {type : String , required : true},
    accessVector : {type : String , required : true},
    accessComplexity : {type : String , required : true},
    authentication : {type : String , required : true},
    confidentialityImpact : {type : String , required : true},
    integrityImpact :  {type : String , required : true},
    availabilityImpact :  {type : String , required : true},


    // ===Score===
    exploitabilityScore : {type : String , required : true},
    impactScore : {type : String , required : true},

    // ===CPE====
    cpeMatch: [{
        vulnerable: { type: String, required: true },
        criteria: { type: String, required: true },
        matchCriteriaId: { type: String, required: true }
    }]

})




export const CveListModel = mongoose.model("cveList" , CveListSchema) ; 